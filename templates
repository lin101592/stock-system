templates/index.html
<!DOCTYPE html>
<html>
<head>
&nbsp;&nbsp;&nbsp;&nbsp;<meta charset="utf-8">
&nbsp;&nbsp;&nbsp;&nbsp;<title>進貨單價查詢系統</title>
&nbsp;&nbsp;&nbsp;&nbsp;<style>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;body {font-family: Microsoft JhengHei;background:#f0f8ff;padding:50px;text-align:center;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.box {width:650px;margin:auto;background:white;padding:40px;border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,0.1);}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input, button {padding:15px;font-size:18px;margin:10px;border-radius:8px;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;button {background:#0066cc;color:white;border:none;cursor:pointer;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.msg {padding:15px;margin:20px;background:#d4edda;color:#155724;border-radius:10px;font-size:18px;}
&nbsp;&nbsp;&nbsp;&nbsp;</style>
</head>
<body>
<div class="box">
&nbsp;&nbsp;&nbsp;&nbsp;<h1>進貨單價查詢系統</h1>
&nbsp;&nbsp;&nbsp;&nbsp;{% if msg %}<div class="msg">{{ msg }}</div>{% endif %}
&nbsp;&nbsp;&nbsp;&nbsp;<h2>1. 匯入 Excel 進貨資料</h2>
&nbsp;&nbsp;&nbsp;&nbsp;<form method="post" enctype="multipart/form-data">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="file" name="file" accept=".xlsx,.xls" required>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button type="submit">開始匯入</button>
&nbsp;&nbsp;&nbsp;&nbsp;</form>
&nbsp;&nbsp;&nbsp;&nbsp;<small>欄位順序：第1欄＝條碼　第2欄＝進貨編號　第3欄＝成本</small>
&nbsp;&nbsp;&nbsp;&nbsp;<hr style="margin:40px 0">
&nbsp;&nbsp;&nbsp;&nbsp;<h2>2. 條碼查詢歷史成本</h2>
&nbsp;&nbsp;&nbsp;&nbsp;<input type="text" id="code" placeholder="請輸入或掃描條碼" size="35" autofocus>
&nbsp;&nbsp;&nbsp;&nbsp;<button onclick="go()">查詢</button>
&nbsp;&nbsp;&nbsp;&nbsp;<div id="result" style="margin-top:30px;font-size:24px;min-height:50px;"></div>
</div>
<script>
async function go() {
&nbsp;&nbsp;&nbsp;&nbsp;const code = document.getElementById('code').value.trim();
&nbsp;&nbsp;&nbsp;&nbsp;if (!code) return;
&nbsp;&nbsp;&nbsp;&nbsp;const res = await fetch('/search/' + code);
&nbsp;&nbsp;&nbsp;&nbsp;const txt = await res.text();
&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById('result').innerHTML = txt || '<span style="color:#999">查無資料</span>';
}
document.getElementById('code').addEventListener('keyup', e => {
&nbsp;&nbsp;&nbsp;&nbsp;if (e.key === 'Enter') go();
});
</script>
</body>
</html>
